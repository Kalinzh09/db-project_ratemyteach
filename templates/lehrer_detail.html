<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>{{ lehrer.vorname }} {{ lehrer.name }}</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
.header-right {
    display: flex;
    gap: 12px;
    align-items: center;
}

#darkmode-btn {
    background: transparent;
    border: 1px solid rgba(255,255,255,0.4);
    color: white;
    padding: 8px 10px;
    border-radius: 10px;
    cursor: pointer;
}
#darkmode-btn:hover {
    border-color: rgba(255,255,255,0.8);
}

body.dark .card {
    background: #0b1220;
    color: #e5e7eb;
    box-shadow: 0 10px 25px rgba(255,255,255,0.04);
}

body.dark textarea,
body.dark input {
    background: #020617;
    color: #f9fafb;
    border: 1px solid #1e293b;
}

body.dark canvas {
    background: transparent;
}
</style>
</head>

<body>

<!-- DARKMODE INIT (MUSS HIER SEIN) -->
<script>
if (localStorage.getItem("darkmode") === "on") {
    document.body.classList.add("dark");
}
</script>

<header>
    <h1>{{ lehrer.vorname }} {{ lehrer.name }}</h1>

    <div class="header-right">
        <button id="darkmode-btn" onclick="toggleDarkMode()">üåô</button>
        <a href="{{ url_for('lehrer_liste') }}" style="color:white;">‚Üê Zur√ºck</a>
    </div>
</header>

<!-- ================= STECKBRIEF ================= -->
<div class="card" style="
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    max-width: 400px;  /* maximale Breite */
    margin: 20px auto; /* zentriert horizontal */
    padding: 15px;     /* optional: Abstand innen */
">
    <h3>Lehrer-Steckbrief</h3>
    <p><strong>Name:</strong> {{ lehrer.vorname }} {{ lehrer.name }}</p>
    <p><strong>E-Mail:</strong> {{ lehrer.email }}</p>
    <p><strong>Fach:</strong> {{ lehrer.fach }}</p>
    <p><strong>Durchschnittliche Sterne:</strong> {{ stats.avg_sterne }}/5</p>
</div>




    
<div class="container">

<div class="card" style="max-width: 1000px; margin: 40px auto; text-align: center;">
    <h3>Lehrer-Statistiken</h3>
    <canvas id="radarChart"></canvas>
</div>

<script>
const isDark = document.body.classList.contains("dark");

new Chart(document.getElementById("radarChart"), {
    type: "radar",
    data: {
        labels: ["Verst√§ndlichkeit", "Fairness", "Sympathie", "Organisation", "Fachwissen"],
        datasets: [{
            label: "Durchschnitt",
            data: [
                {{ stats.verstandlichkeit }},
                {{ stats.fairness }},
                {{ stats.sympathie }},
                {{ stats.organisation }},
                {{ stats.fachwissen }}
            ],
            fill: true,
            backgroundColor: isDark ? "rgba(56,189,248,0.15)" : "rgba(79,70,229,0.18)",
            borderColor: isDark ? "rgba(56,189,248,0.95)" : "rgba(79,70,229,0.95)",
            pointBackgroundColor: isDark ? "#38bdf8" : "#4f46e5"
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
            r: {
                min: 0,
                max: 5,
                ticks: {
                    stepSize: 1,
                    color: isDark ? "#e5e7eb" : "#111827",
                    backdropColor: "transparent"
                },
                grid: {
                    color: isDark ? "rgba(255,255,255,0.30)" : "rgba(17,24,39,0.12)"
                },
                angleLines: {
                    color: isDark ? "rgba(255,255,255,0.30)" : "rgba(17,24,39,0.12)"
                },
                pointLabels: {
                    color: isDark ? "#cbd5e1" : "#111827"
                }
            }
        }
    }
});
</script>



    
{% if anzbewertungenuser == 0 %}
<div class="card">
<h3>Bewertung abgeben</h3>

<form method="post">

<label>Verst√§ndlichkeit</label>
<input type="range" min="1" max="5" step="0.5" name="verstandlichkeit" required>

<label>Fairness</label>
<input type="range" min="1" max="5" step="0.5" name="fairness" required>

<label>Sympathie</label>
<input type="range" min="1" max="5" step="0.5" name="sympathie" required>

<label>Organisation</label>
<input type="range" min="1" max="5" step="0.5" name="organisation" required>

<label>Fachwissen</label>
<input type="range" min="1" max="5" step="0.5" name="fachwissen" required>

<textarea name="kommentar" placeholder="Kommentar..."></textarea>

<button type="submit"
onclick="this.disabled=true; this.innerText='Wird gesendet‚Ä¶'; this.form.submit();">
Absenden
</button>

</form>
</div>
{% endif %}

{% for b in bewertungen %}
<div class="card">
<strong>{{ b.username }}</strong><br>

{% set full = b.sterne|int %}
{% set half = 1 if (b.sterne - full) >= 0.5 else 0 %}
{% set empty = 5 - full - half %}

{% for i in range(full) %}<span class="star full">‚òÖ</span>{% endfor %}
{% if half %}<span class="star half">‚òÖ</span>{% endif %}
{% for i in range(empty) %}<span class="star empty">‚òÜ</span>{% endfor %}

({{ b.sterne }}/5)<br>
<small>{{ b.datum }}</small>
<p>{{ b.kommentar }}</p>
</div>
{% endfor %}

</div>

<script>
const isDark = document.body.classList.contains("dark");

new Chart(document.getElementById("radarChart"), {
    type: "radar",
    data: {
        labels: ["Verst√§ndlichkeit", "Fairness", "Sympathie", "Organisation", "Fachwissen"],
        datasets: [{
            label: "Durchschnitt",
            data: [
                {{ stats.verstandlichkeit }},
                {{ stats.fairness }},
                {{ stats.sympathie }},
                {{ stats.organisation }},
                {{ stats.fachwissen }}
            ],
            fill: true,
            backgroundColor: isDark ? "rgba(56,189,248,0.15)" : "rgba(79,70,229,0.18)",
            borderColor: isDark ? "rgba(56,189,248,0.95)" : "rgba(79,70,229,0.95)",
            pointBackgroundColor: isDark ? "#38bdf8" : "#4f46e5"
        }]
    },
    options: {
        scales: {
            r: {
                min: 0,
                max: 5,
                ticks: {
                    stepSize: 1,
                    color: isDark ? "#e5e7eb" : "#111827",
                    backdropColor: "transparent"
                },
                grid: {
                    color: isDark ? "rgba(255,255,255,0.30)" : "rgba(17,24,39,0.12)"
                },
                angleLines: {
                    color: isDark ? "rgba(255,255,255,0.30)" : "rgba(17,24,39,0.12)"
                },
                pointLabels: {
                    color: isDark ? "#cbd5e1" : "#111827"
                }
            }
        }
    }
});
</script>

<script>
function toggleDarkMode() {
    document.body.classList.toggle("dark");
    localStorage.setItem(
        "darkmode",
        document.body.classList.contains("dark") ? "on" : "off"
    );
}
</script>

</body>
</html>
