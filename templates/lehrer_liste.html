{% extends "base.html" %}
{% block title %}Lehrerbewertung{% endblock %}

{% block content %}

<form method="get" style="margin-bottom:20px;">
    <input type="text"
           name="q"
           placeholder="Lehrer oder Fach suchenâ€¦"
           value="{{ q }}"
           style="padding:10px; width:70%; max-width:300px;">

    <button type="submit" style="padding:10px;">
        Suchen
    </button>
</form>


{% if is_admin(current_user) %}
  <div style="margin-bottom:20px;">
    <a class="button" href="{{ url_for('add_lehrer') }}">
      âž• Lehrer hinzufÃ¼gen
    </a>
  </div>
{% endif %}

{% for l in lehrer %}
  <div class="card">
    <h2>
      {{ l.vorname }} {{ l.name }}
      <span class="badge">{{ l.fach }}</span>
    </h2>

    <p class="rating">
      {% if l.avg_sterne is not none %}
        {% set full = l.avg_sterne|int %}
        {% set half = 1 if (l.avg_sterne - full) >= 0.5 else 0 %}
        {% set empty = 5 - full - half %}

        {% for _ in range(full) %}<span class="star full">â˜…</span>{% endfor %}
        {% if half %}<span class="star half">â˜…</span>{% endif %}
        {% for _ in range(empty) %}<span class="star empty">â˜†</span>{% endfor %}

        {{ l.avg_sterne }} / 5
      {% else %}
        Noch keine Bewertungen
      {% endif %}
    </p>

    <a class="button" href="{{ url_for('lehrer_detail', lehrer_id=l.id) }}">
      Bewerten / Details
    </a>

    {% if is_admin(current_user) %}
      <form method="POST"
            action="{{ url_for('delete_lehrer', lehrer_id=l.id) }}"
            onsubmit="return confirm('Lehrer wirklich lÃ¶schen?');"
            style="margin-top:10px;">
        <button class="button danger">ðŸ—‘ Lehrer lÃ¶schen</button>
      </form>
    {% endif %}
  </div>
{% endfor %}

{% endblock %}
